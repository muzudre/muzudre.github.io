$(document).ready(function () {
  function e() {
    var e,
      a,
      t,
      o = $("#search_input"),
      n = $(".search_result");
    o.focus(function () {
      $(".icon-search").css("color", "#3199DB"), n.show();
    }),
      o.keyup(
        ((e = this.autoComplete),
          (a = a || 120),
          function () {
            var o = this,
              n = arguments;
            clearTimeout(t),
              (t = setTimeout(function () {
                e.apply(o, n);
              }, a));
          })
      ),
      $(document).click(function (e) {
        "search_input" !== e.target.id &&
          "search_result" !== e.target.className &&
          "search_item" !== e.target.className &&
          ($(".icon-search").css("color", "#CAD3DC"), n.hide());
      });
  }
  var a,
    t,
    o = $(".g-nav");
  if (
    ($("#menu-toggle").on("click", function (e) {
      o.slideToggle(200),
        $(document).on("click", function () {
          o.slideUp(200);
        }),
        e.stopPropagation();
    }),
      o.on("click", function (e) {
        e.stopPropagation();
      }),
      $(window).width() > 695)
  ) {
    var s = $(".g-header"),
      r = s.outerHeight(),
      c = $(".g-logo"),
      i = o.find("a"),
      l = $(".g-banner").attr("data-theme"),
      h = $(document).scrollTop();
    $(document).scroll(function () {
      var e = $(this).scrollTop(),
        a = "nav-" + l;
      e > r
        ? (e > 3 * r && s.addClass("headerUp"),
          s.css({
            "background-color": "rgba(255, 255, 255, .98)",
            "box-shadow": "0 1px 12px rgba(0, 0, 0, .08)"
          }),
          c.css({
            background:
              "url(/mozghub/assets/icons/logo_" + l + ".png) no-repeat center",
            "background-size": "100% 100%"
          }),
          i.css("color", "#666"),
          o.addClass(a))
        : (s.removeClass("headerUp"),
          s.css({ "background-color": "transparent", "box-shadow": "none" }),
          c.css({
            background: "url(/mozghub/assets/icons/logo.png) no-repeat center",
            "background-size": "100% 100%"
          }),
          i.css("color", "#fff"),
          o.removeClass(a)),
        h > e ? s.addClass("headerDown") : s.removeClass("headerDown"),
        (h = e);
    });
  }
  $(".read-next-item section").each(function () {
    var e = $(this).height(),
      a = $(".read-next-item").height();
    $(this).css("margin-top", (a - e) / 2 + "px"), $(this).fadeIn();
  }),
    $(".read-next-item img").each(function () {
      !(function (e, a) {
        e.width(), a.width();
        var t = e.height(),
          o = a.height();
        if (t < o) {
          e.css({ width: "auto", height: "100%" });
          var n = (e.width() - a.width()) / 2;
          e.css("margin-left", "-" + n + "px");
        } else {
          var s = (o - t) / 2;
          e.css("margin-top", s + "px");
        }
        e.fadeIn();
      })($(this), $(".read-next-item"));
    }),
    (function () {
      for (
        var e = parseInt($("#total_pages").val()),
        a = parseInt($("#current_pages").val()),
        t = $("#base_url").val(),
        o = "",
        n = a - 3;
        n < a;
        n++
      )
        n > 0 && 1 !== n
          ? (o +=
            '<a href="' +
            t +
            "page" +
            n +
            '" class="page-link page-num">' +
            n +
            "</a>")
          : 1 === n &&
          (o +=
            '<a href="' + t + '" class="page-link page-num">' + n + "</a>");
      o += '<span class="page-link page-num active">' + a + "</span>";
      for (var s = a + 1; s <= a + 3; s++)
        s <= e &&
          (o +=
            '<a href="' +
            t +
            "page" +
            s +
            '" class="page-link page-num">' +
            s +
            "</a>");
      $("#page-link-container").html(o);
    })(),
    (e.prototype.autoComplete = function () {
      var e = this.value.toLowerCase();
      e.length
        ? $(".icon-search").css("color", "#3199DB")
        : $(".icon-search").css("color", "#CAD3DC"),
        $.getJSON("/mozghub/search.json").done(function (a) {
          var t = "";
          for (var o in a) {
            var n = a[o],
              s = n.title,
              r = n.tags,
              c = (n.url, s + r);
            "" !== e &&
              c.toLowerCase().indexOf(e) >= 0 &&
              (t +=
                '<a class="search_item" href="/mozghub' +
                n.url +
                '">' +
                n.title +
                "</a>");
          }
          $(".search_result").html(t);
        });
    }),
    new e(),
    "true" === $("#nm-switch").val() &&
    ((a = $("body")),
      (((t = new Date().getHours()) >= 0 && t <= 6) || 23 === t) &&
      a.addClass("night-mode")),
    $(".post-content").on("mouseup", function (e) {
      var a = window.getSelection();
      a.toString().length >= 30 && n(a);
    });
});
